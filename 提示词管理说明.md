# 提示词管理功能说明

## 功能概述
v16.0 版本新增了**自定义提示词管理**功能，允许用户自定义AI评审和修订的提示词模板。

## 如何使用

### 1. 访问提示词管理界面
- 打开应用后，在左侧边栏点击 **"提示词管理"** 标签
- 您将看到当前所有的提示词模板列表

### 2. 查看提示词详情
- 点击任意提示词卡片的 **"查看详情"** 可展开查看完整的提示词内容
- 当前启用的提示词会有 **"✓ 当前使用"** 标识和蓝色边框

### 3. 添加新提示词
在页面底部的 **"添加新提示词"** 表单中：

1. **提示词名称**: 给您的提示词起一个易识别的名字
2. **评审提示词**: 定义AI如何评审其他模型的答案
   - 使用占位符：
     - `{question}` - 用户的问题
     - `{target}` - 被评审模型的名称
     - `{answer}` - 被评审的答案内容

3. **修订提示词**: 定义AI如何根据评审意见改进答案
   - 使用占位符：
     - `{original}` - 原始答案
     - `{feedback}` - 收到的评审意见

### 4. 编辑提示词
- 点击提示词卡片上的 **"编辑"** 按钮
- 在弹出的对话框中修改内容
- 点击确定保存更改

### 5. 启用/切换提示词
- 点击非活动提示词的 **"启用"** 按钮即可切换
- 系统会立即应用新的提示词，影响后续所有的AI对话

### 6. 删除提示词
- 点击 **"删除"** 按钮可删除不需要的提示词
- 注意：系统至少保留一个提示词，最后一个无法删除

## 提示词示例

### 严格评审型
```
严格评审以下答案，找出缺陷并提出改进建议。

问题: {question}
答案来自: {target}
答案内容: {answer}

评分标准(每项0-3分):
1. 准确性: 3=完全准确 2=基本准确 1=有错误 0=严重错误
2. 完整性: 3=全面覆盖 2=略有遗漏 1=明显不足 0=严重不完整
3. 清晰性: 3=清晰明了 2=基本清晰 1=表达混乱 0=难以理解
4. 实用性: 3=非常实用 2=有帮助 1=缺乏实操性 0=无用

输出格式:
准确性: [0-3]
完整性: [0-3]
清晰性: [0-3]
实用性: [0-3]
总分: [总和]
评语: [指出缺陷和改进建议]
```

### 友好建议型
```
请友好地评审以下答案，重点关注其优点和可改进之处。

原问题: {question}
来自模型: {target}
答案: {answer}

请从以下维度给出评分(0-3分):
- 准确性: 信息是否正确
- 完整性: 是否充分回答问题
- 清晰性: 表达是否清楚
- 实用性: 是否对用户有帮助

格式:
准确性: [分数]
完整性: [分数]
清晰性: [分数]
实用性: [分数]
总分: [总和]
评语: [友好的评价和建议]
```

### 专业学术型
```
作为学术评审专家，请评估以下答案的学术价值。

研究问题: {question}
被评估答案 (来自{target}): {answer}

评估维度 (每项0-3分):
1. 学术严谨性 (Rigor)
2. 文献支持 (Evidence)
3. 逻辑连贯性 (Coherence)
4. 创新价值 (Innovation)

请按格式输出:
准确性: [分数]
完整性: [分数]
清晰性: [分数]
实用性: [分数]
总分: [总和]
评语: [学术评价]
```

## 高级技巧

### 1. 提示词调优
- 观察AI的输出质量，不断调整提示词
- 确保输出格式固定，便于系统解析评分
- 评分必须包含：准确性、完整性、清晰性、实用性四个维度

### 2. 针对特定场景
- 可以为不同应用场景创建多个提示词
- 例如：代码审查、论文评审、创意写作评估等
- 使用时切换到对应的提示词即可

### 3. 占位符使用注意
- 占位符必须完全匹配：`{question}` `{target}` `{answer}` `{original}` `{feedback}`
- 大小写敏感，不要修改占位符名称
- 可以在提示词中多次使用同一占位符

## 技术细节

- 提示词存储在SQLite数据库中
- 修改提示词立即生效，无需重启服务
- 系统使用Python的`str.format()`方法进行占位符替换
- 所有提示词更改都有版本控制（通过数据库记录）

## 常见问题

**Q: 修改提示词会影响历史对话吗？**
A: 不会。只影响修改后的新对话。

**Q: 可以导入/导出提示词吗？**
A: 当前版本暂不支持，但数据存储在 `providers.db` 的 `prompts` 表中，可手动备份。

**Q: 评分解析失败怎么办？**
A: 确保提示词要求AI严格按照格式输出，包含四个维度的分数和总分。

**Q: 可以有多个活跃的提示词吗？**
A: 不可以，系统同时只能有一个活跃的提示词模板。
