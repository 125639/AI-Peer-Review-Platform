# 标签页不工作 - 终极解决方案

## 🔴 已更新文件
1. ✅ script.js 已更新到 v17.0.0（带时间戳）
2. ✅ index.html 已添加缓存破坏器 (?v=20250126203000)

## 📋 按顺序执行以下步骤

### 步骤 1: 完全清除浏览器缓存（必须！）

**Chrome/Edge:**
1. 按 `Ctrl + Shift + Delete`
2. 时间范围选择：**全部时间**
3. 勾选：**缓存的图片和文件**
4. 点击"清除数据"
5. **关闭所有浏览器窗口**
6. 重新打开浏览器

**或者使用无痕模式:**
- 按 `Ctrl + Shift + N`
- 访问 http://127.0.0.1:8000

### 步骤 2: 访问诊断页面

打开浏览器，访问：
```
http://127.0.0.1:8000/诊断.html
```

这个页面会：
- ✅ 测试标签页切换是否工作
- ✅ 检查缓存状态
- ✅ 显示实时日志
- ✅ 检测主应用版本

**如果诊断页面的标签页能切换，说明浏览器工作正常！**

### 步骤 3: 访问主应用

访问：http://127.0.0.1:8000

按 `F12` 打开控制台，应该看到：
```
🚀 Script v17.0.0 loaded - Timestamp: 2025-01-26-20:30:00
✅ Prompt Management Feature Enabled
✅ Tab Switching Feature Enabled
DOM loaded, initializing v17.0.0...
Tab buttons found: 2
```

**如果还是显示 v15.0.0，说明缓存未清除！**

### 步骤 4: 测试标签页

1. 点击"提示词管理"按钮
2. 观察控制台输出，应该看到：
   ```
   Tab clicked: prompts
   Removing active from: models-tab
   Removing active from: prompts-tab
   Tab activated: prompts Display: flex
   ```

### 步骤 5: 如果还是不行

**方案 A: 重启服务器**
```powershell
# 停止当前服务器（在 Python 终端按 Ctrl+C）

# 然后运行：
cd "d:\shiyan\新建文件夹\AI-Peer-Review-Platform"
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

**方案 B: 使用不同端口**
```powershell
uvicorn main:app --host 0.0.0.0 --port 8001 --reload
```
然后访问：http://127.0.0.1:8001

**方案 C: 手动检查文件**
在控制台运行：
```javascript
fetch('/static/script.js?t=' + Date.now())
  .then(r => r.text())
  .then(t => {
    const match = t.match(/Version:\s*([\d.]+)/);
    console.log('服务器上的版本:', match ? match[1] : '未知');
    console.log('包含标签页代码:', t.includes('标签页切换'));
  });
```

## 🎯 核心问题

您的浏览器缓存了旧版本的 script.js 文件：
- **缓存版本**: v15.0.0 (没有标签页功能)
- **实际版本**: v17.0.0 (有标签页功能)

**必须清除缓存才能加载新版本！**

## ⚡ 最快的解决方法

1. **完全关闭所有浏览器窗口**（不是标签页，是整个浏览器）
2. **重新打开浏览器**
3. **按 Ctrl+Shift+N 打开无痕窗口**
4. **访问 http://127.0.0.1:8000**
5. **按 F12 查看控制台版本号**

如果无痕模式能看到 v17.0.0 并且标签页能切换，说明问题就是缓存！

## 📞 反馈信息

请告诉我：
1. 诊断页面（http://127.0.0.1:8000/诊断.html）的标签页能切换吗？
2. 控制台显示的版本号是多少？
3. 您使用的是什么浏览器？（Chrome/Edge/Firefox）
4. 是否已经完全关闭并重启浏览器？
